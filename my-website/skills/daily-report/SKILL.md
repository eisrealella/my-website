# Skill: daily-report

自动化生成并写入飞书工作日报。

## 触发条件
- 用户请求写日报
- cron 定时任务触发

## 单一规则（必须遵守）
- 标题格式固定：`## 📅 YYYY年M月D日`（不要加“工作日报”后缀）
- 同一天只允许一篇日报，禁止重复写入
- 新日报必须位于文档最上方（最新在前）
- 完成后仅回复：`日报已更新`

## 时间语义
- 10:00（morning）：写前一天日报
- 18:00（evening）：写当天日报
- 若用户显式指定日期，以用户指定日期为准

## 执行流程
1. 确定目标日期（YYYY年M月D日）。
2. 先 `feishu_doc read` 全文，检查是否已存在该日期标题。
3. 若已存在，停止写入，直接返回 `日报已更新`。
4. 按模板生成日报正文。
5. 将新日报写到文档最上方：
   - 优先使用支持“顶部插入”的能力。
   - 若只有 `append`，先 append，再进行块重排，把新日报移动到最上方。
   - 如果无法保证“最上方”，必须明确报错，不得声称成功。
6. 再次 `feishu_doc read` 校验三件事：
   - 新日报在最上方
   - 标题格式正确
   - 模板结构完整
7. 校验通过后回复 `日报已更新`。

## 模板

```markdown
## 📅 {日期}

### 🟢 今日完成
**核心任务**
- 核心工作1
- 核心工作2
- 核心工作3

**技术细节**
- 配置/代码变更具体值
- 技术决策点

### 🔵 明日计划
- [ ] 计划任务1
- [ ] 计划任务2

### 💡 思考与复盘
**做得好的**
- 成功点1

**可以更好的**
- 改进点1
```

## 依赖工具
- `feishu_doc`: `read`, `append`, `list_blocks`（以及可用的块重排能力）
- `exec`: 日期计算（必要时）
